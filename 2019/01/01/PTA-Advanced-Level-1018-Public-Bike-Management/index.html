<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/ortrait.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/ortrait.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/ortrait.jpg">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"www.suvvm.work","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="There is a public bike service in Hangzhou City which provides great convenience to the tourists from all over the world. One may rent a bike at any station and return it to any other stations in th">
<meta property="og:type" content="article">
<meta property="og:title" content="PTA (Advanced Level) 1018 Public Bike Management">
<meta property="og:url" content="https://www.suvvm.work/2019/01/01/PTA-Advanced-Level-1018-Public-Bike-Management/index.html">
<meta property="og:site_name" content="SUVVM">
<meta property="og:description" content="There is a public bike service in Hangzhou City which provides great convenience to the tourists from all over the world. One may rent a bike at any station and return it to any other stations in th">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://images.ptausercontent.com/213">
<meta property="article:published_time" content="2019-01-01T11:42:15.000Z">
<meta property="article:modified_time" content="2020-12-19T14:05:00.652Z">
<meta property="article:author" content="SUVVM">
<meta property="article:tag" content="DFS（深度优先搜索）">
<meta property="article:tag" content="最短路">
<meta property="article:tag" content="PTA">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://images.ptausercontent.com/213">

<link rel="canonical" href="https://www.suvvm.work/2019/01/01/PTA-Advanced-Level-1018-Public-Bike-Management/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>PTA (Advanced Level) 1018 Public Bike Management | SUVVM</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?e5190116d64be66cac29daef18c94ac0";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">SUVVM</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">呜嗷SUVVM</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/schedule/" rel="section"><i class="calendar fa-fw"></i>日程表</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.suvvm.work/2019/01/01/PTA-Advanced-Level-1018-Public-Bike-Management/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/ortrait.jpg">
      <meta itemprop="name" content="SUVVM">
      <meta itemprop="description" content="SUVVM的个人博客，主要涉及编程知识分享、算法题解等方面">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SUVVM">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          PTA (Advanced Level) 1018 Public Bike Management
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-01-01 19:42:15" itemprop="dateCreated datePublished" datetime="2019-01-01T19:42:15+08:00">2019-01-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-12-19 22:05:00" itemprop="dateModified" datetime="2020-12-19T22:05:00+08:00">2020-12-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95%E7%9B%B8%E5%85%B3/" itemprop="url" rel="index"><span itemprop="name">算法相关</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><meta name="referrer" content="no-referrer"><br>　　There is a public bike service in Hangzhou City which provides great convenience to the tourists from all over the world. One may rent a bike at any station and return it to any other stations in the city.</p>
<p>　　The Public Bike Management Center (PBMC) keeps monitoring the real-time capacity of all the stations. A station is said to be in perfectcondition if it is exactly half-full. If a station is full or empty, PBMC will collect or send bikes to adjust the condition of that station to perfect. And more, all the stations on the way will be adjusted as well.</p>
<p>　　When a problem station is reported, PBMC will always choose the shortest path to reach that station. If there are more than one shortest path, the one that requires the least number of bikes sent from PBMC will be chosen.</p>
<p><img src="https://images.ptausercontent.com/213" alt="img"></p>
<p>　　The above figure illustrates an example. The stations are represented by vertices and the roads correspond to the edges. The number on an edge is the time taken to reach one end station from another. The number written inside a vertex S is the current number of bikes stored at S. Given that the maximum capacity of each station is 10. To solve the problem at S3, we have 2 different shortest paths:</p>
<ol>
<li>PBMC -&gt; S1 -&gt; S3. In this case, 4 bikes must be sent from PBMC, because we can collect 1 bike from S1 and then take 5 bikes to S3, so that both stations will be in perfect conditions.</li>
<li>PBMC -&gt; S2 -&gt; S3. This path requires the same time as path 1, but only 3 bikes sent from PBMC and hence is the one that will be chosen.</li>
</ol>
<h3 id="Input-Specification"><a href="#Input-Specification" class="headerlink" title="Input Specification:"></a>Input Specification:</h3><p>　　Each input file contains one test case. For each case, the first line contains 4 numbers: Cmax (≤), always an even number, is the maximum capacity of each station; N (≤), the total number of stations; Sp, the index of the problem station (the stations are numbered from 1 to N, and PBMC is represented by the vertex 0); and M, the number of roads. The second line contains N non-negative numbers Ci (,) where each Ci is the current number of bikes at Si respectively. Then Mlines follow, each contains 3 numbers: Si, Sj, and Tij which describe the time Tij taken to move betwen stations Si and Sj. All the numbers in a line are separated by a space.</p>
<h3 id="Output-Specification"><a href="#Output-Specification" class="headerlink" title="Output Specification:"></a>Output Specification:</h3><p>　　For each test case, print your results in one line. First output the number of bikes that PBMC must send. Then after one space, output the path in the format: 0. Finally after another space, output the number of bikes that we must take back to PBMC after the condition of Sp is adjusted to perfect.</p>
<p>　　Note that if such a path is not unique, output the one that requires minimum number of bikes that we must take back to PBMC. The judge’s data guarantee that such a path is unique.</p>
<h3 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input:"></a>Sample Input:</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">10 3 3 5</span><br><span class="line">6 7 0</span><br><span class="line">0 1 1</span><br><span class="line">0 2 1</span><br><span class="line">0 3 3</span><br><span class="line">1 3 1</span><br><span class="line">2 3 1</span><br></pre></td></tr></table></figure>
<h3 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output:"></a>Sample Output:</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3 0-&gt;2-&gt;3 0</span><br></pre></td></tr></table></figure>
<p>解题思路：<br>　　本题题意是，杭州市有一些共享单车站，给出车站的最大容量（一定是偶数），给出车站数量与车站之间道路的信息，车站的最优状态为最大容量的一半。给定目标车站，控制中心现在要携带或从路过的其他车站取出一些自行车，使路程中路过的所有车站和目标车站都变为最优状态，多的自行车将被带回控制中心。要求计算并输出最短路径和最短路径情况下的携带数与带回数，如果有多条最短路径那么选择携带数最少的一条，如果还有是多条路径，那么选择带回数最少的一条。（到达目标车站后之间带着多余的自行车之间传送回控制中心，不在经过任何车站）。</p>
<p>　　输入信息：第一行给出4个整数，分别为 最大容量Cmax ，车站数量n， 目标车站sp，道路数量m，下一行给出n个整数代表每个车站当前自行车数量，之后跟随m行，每行3个整数，分别为，道路连接的两个车站和道路长度。</p>
<p>　　车站的范围为1 ~ n，0为控制中心。</p>
<p>　　可以先用迪杰斯特拉获得所有最短路径。之后搜索所有最短路径获得携带数（携带数相同获得最小的带回数）最小的路径，按要求输出。</p>
<p>　　利用Dijkstra建立一颗最短路径树</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Dijkstra</span><span class="params">(<span class="keyword">int</span> st)</span></span>&#123;  <span class="comment">//传入起点，这里之间传入0控制中心即可</span></span><br><span class="line">    dis[st] = <span class="number">0</span>;    <span class="comment">//dis储存控制中心到所有车站的最短距离</span></span><br><span class="line">    <span class="comment">//控制中心到自己的最短距离为0</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++)&#123;    <span class="comment">//获取没有访问过的车站中距离控制中心最近的车站</span></span><br><span class="line">        <span class="keyword">int</span> u = <span class="number">-1</span>, minLength = INT_MAX;</span><br><span class="line">        <span class="comment">//u记录最近的车站， minLength记录最短距离</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= n; j++)&#123;</span><br><span class="line">            <span class="comment">//vis记录车站是否已经访问</span></span><br><span class="line">            <span class="keyword">if</span>(dis[j] &lt; minLength &amp;&amp; !vis[j])&#123;</span><br><span class="line">                u = j;</span><br><span class="line">                minLength = dis[j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(u == <span class="number">-1</span>) <span class="comment">//如果u还是-1表示其他车站和控制中心不连通</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        vis[u] = <span class="literal">true</span>;  <span class="comment">//将最近的车站标记为已访问</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= n; j++)&#123;    <span class="comment">//遍历所有结点用u车站优化控制中心与其他未访问车站的距离</span></span><br><span class="line">            <span class="keyword">if</span>(!vis[j] &amp;&amp; G[u][j] != INT_MAX)&#123;  <span class="comment">//j车站未访问且与u车站之间有道路</span></span><br><span class="line">                <span class="keyword">if</span>(dis[j] &gt; dis[u] + G[u][j])&#123;  <span class="comment">//判断是否能优化</span></span><br><span class="line">                    dis[j] = dis[u] + G[u][j];  <span class="comment">//如果能优化</span></span><br><span class="line">                    pre[j].clear(); <span class="comment">//j车站的前驱车站清空并重新记录为u</span></span><br><span class="line">                    pre[j].push_back(u);</span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>(dis[j] == dis[u] + G[u][j])&#123;</span><br><span class="line">                    <span class="comment">//若不能优化但是以u为中转是j车站到控制中心的距离和dis数组中记录的 j车站到控制中心的距离相等</span></span><br><span class="line">                    <span class="comment">//j车站的前驱增加u</span></span><br><span class="line">                    pre[j].push_back(u);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> 之后深搜遍历最短路径树获得携带数最少（如果仍有多条道路则获得带回数最少）的路线。 </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span><span class="params">(<span class="keyword">int</span> v)</span></span>&#123;    </span><br><span class="line">    <span class="keyword">if</span>(v == <span class="number">0</span>)&#123; <span class="comment">//这里我们逆序遍历路径，从终点车站开始到控制中心0为止</span></span><br><span class="line">        <span class="comment">//应为最短路径树中记录控制0为叶子结点，目标车站sp为根结点</span></span><br><span class="line">        path.push_back(<span class="number">0</span>);</span><br><span class="line">        judge();    <span class="comment">//判断当前路径的携带数与带回树是否可以优化答案</span></span><br><span class="line">        path.pop_back();</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    path.push_back(v);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> i : pre[v])&#123;</span><br><span class="line">        DFS(i);</span><br><span class="line">    &#125;</span><br><span class="line">    path.pop_back();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> 　　由于DFS中我们时倒序遍历的最短路径，所以在判断每条路径是否可以优化答案时，要先将DFS中获取的路径反转，之后遍历这条路径获得其携带数与带回数即可。 </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">judge</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> need = <span class="number">0</span>, backn = <span class="number">0</span>;    <span class="comment">//need记录携带数 backn记录带回数</span></span><br><span class="line">    <span class="keyword">int</span> half = Cmax / <span class="number">2</span>;    <span class="comment">//half记录最优状态车站中车辆数</span></span><br><span class="line">    reverse(path.begin(), path.end());</span><br><span class="line">    <span class="keyword">bool</span> flag = <span class="literal">false</span>;  <span class="comment">//道路开始位置为控制中心0，我们不需要将控制中心的车辆数调整为最优状态</span></span><br><span class="line">    <span class="comment">//所以我们用flag = false表示正在访问控制中心</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> i : path)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!flag)&#123;  <span class="comment">//跳过控制中心</span></span><br><span class="line">            flag = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(spValue[i] &gt; half)&#123;  <span class="comment">//当前车站中的共享单车数量大于最优状态数量</span></span><br><span class="line">            backn += spValue[i] - half; <span class="comment">//将多出的车辆带走</span></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(backn &gt; half - spValue[i])   <span class="comment">//如果当前携带的车辆足以将该车站补充为最优状态</span></span><br><span class="line">                backn -= half - spValue[i]; <span class="comment">//当前携带数减去缺少车辆数</span></span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                need += (half - spValue[i]) - backn;    </span><br><span class="line">                <span class="comment">//如果不足以补足当前车站就将所有携带车辆放入该车站，之后还是不足的车辆从控制中心携带</span></span><br><span class="line">                backn = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(need &lt; minNeed)&#123; <span class="comment">//比较答案与当前路径的携带数</span></span><br><span class="line">        minNeed = need;</span><br><span class="line">        minBack = backn;</span><br><span class="line">        ansPath = path;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(need == minNeed &amp;&amp; backn &lt; minBack)&#123;   <span class="comment">//携带数一致比较带回数</span></span><br><span class="line">        minBack = backn;</span><br><span class="line">        ansPath = path;</span><br><span class="line">    &#125;</span><br><span class="line">    reverse(path.begin(), path.end());  <span class="comment">//为了继续DFS重新将路径反转</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> AC代码 </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">510</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, Cmax, sp; <span class="comment">//n记录车站数量， m记录道路数量， Cmax记录车站最大容量（Cmax/2就是车站最优数量）</span></span><br><span class="line"><span class="keyword">int</span> G[maxn][maxn];  <span class="comment">//G储存车站之间的邻接矩阵</span></span><br><span class="line"><span class="keyword">int</span> spValue[maxn], dis[maxn];   <span class="comment">//spValue记录每个车站当前的车辆数， dis记录每个车站到控制中心的最短距离</span></span><br><span class="line"><span class="keyword">bool</span> vis[maxn] = &#123;<span class="literal">false</span>&#125;;   <span class="comment">//vis用于在寻找最短路径时判断车站是否已经访问</span></span><br><span class="line"><span class="keyword">int</span> minNeed, minBack;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; path, ansPath, pre[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Dijkstra</span><span class="params">(<span class="keyword">int</span> st)</span></span>&#123;  <span class="comment">//传入起点，这里之间传入0控制中心即可</span></span><br><span class="line">    dis[st] = <span class="number">0</span>;    <span class="comment">//dis储存控制中心到所有车站的最短距离</span></span><br><span class="line">    <span class="comment">//控制中心到自己的最短距离为0</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++)&#123;    <span class="comment">//获取没有访问过的车站中距离控制中心最近的车站</span></span><br><span class="line">        <span class="keyword">int</span> u = <span class="number">-1</span>, minLength = INT_MAX;</span><br><span class="line">        <span class="comment">//u记录最近的车站， minLength记录最短距离</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= n; j++)&#123;</span><br><span class="line">            <span class="comment">//vis记录车站是否已经访问</span></span><br><span class="line">            <span class="keyword">if</span>(dis[j] &lt; minLength &amp;&amp; !vis[j])&#123;</span><br><span class="line">                u = j;</span><br><span class="line">                minLength = dis[j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(u == <span class="number">-1</span>) <span class="comment">//如果u还是-1表示其他车站和控制中心不连通</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        vis[u] = <span class="literal">true</span>;  <span class="comment">//将最近的车站标记为已访问</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= n; j++)&#123;    <span class="comment">//遍历所有结点用u车站优化控制中心与其他未访问车站的距离</span></span><br><span class="line">            <span class="keyword">if</span>(!vis[j] &amp;&amp; G[u][j] != INT_MAX)&#123;  <span class="comment">//j车站未访问且与u车站之间有道路</span></span><br><span class="line">                <span class="keyword">if</span>(dis[j] &gt; dis[u] + G[u][j])&#123;  <span class="comment">//判断是否能优化</span></span><br><span class="line">                    dis[j] = dis[u] + G[u][j];  <span class="comment">//如果能优化</span></span><br><span class="line">                    pre[j].clear(); <span class="comment">//j车站的前驱车站清空并重新记录为u</span></span><br><span class="line">                    pre[j].push_back(u);</span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>(dis[j] == dis[u] + G[u][j])&#123;</span><br><span class="line">                    <span class="comment">//若不能优化但是以u为中转是j车站到控制中心的距离和dis数组中记录的 j车站到控制中心的距离相等</span></span><br><span class="line">                    <span class="comment">//j车站的前驱增加u</span></span><br><span class="line">                    pre[j].push_back(u);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">judge</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> need = <span class="number">0</span>, backn = <span class="number">0</span>;    <span class="comment">//need记录携带数 backn记录带回数</span></span><br><span class="line">    <span class="keyword">int</span> half = Cmax / <span class="number">2</span>;    <span class="comment">//half记录最优状态车站中车辆数</span></span><br><span class="line">    reverse(path.begin(), path.end());</span><br><span class="line">    <span class="keyword">bool</span> flag = <span class="literal">false</span>;  <span class="comment">//道路开始位置为控制中心0，我们不需要将控制中心的车辆数调整为最优状态</span></span><br><span class="line">    <span class="comment">//所以我们用flag = false表示正在访问控制中心</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> i : path)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!flag)&#123;  <span class="comment">//跳过控制中心</span></span><br><span class="line">            flag = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(spValue[i] &gt; half)&#123;  <span class="comment">//当前车站中的共享单车数量大于最优状态数量</span></span><br><span class="line">            backn += spValue[i] - half; <span class="comment">//将多出的车辆带走</span></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(backn &gt; half - spValue[i])   <span class="comment">//如果当前携带的车辆足以将该车站补充为最优状态</span></span><br><span class="line">                backn -= half - spValue[i]; <span class="comment">//当前携带数减去缺少车辆数</span></span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                need += (half - spValue[i]) - backn;</span><br><span class="line">                <span class="comment">//如果不足以补足当前车站就将所有携带车辆放入该车站，之后还是不足的车辆从控制中心携带</span></span><br><span class="line">                backn = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(need &lt; minNeed)&#123; <span class="comment">//比较答案与当前路径的携带数</span></span><br><span class="line">        minNeed = need;</span><br><span class="line">        minBack = backn;</span><br><span class="line">        ansPath = path;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(need == minNeed &amp;&amp; backn &lt; minBack)&#123;   <span class="comment">//携带数一致比较带回数</span></span><br><span class="line">        minBack = backn;</span><br><span class="line">        ansPath = path;</span><br><span class="line">    &#125;</span><br><span class="line">    reverse(path.begin(), path.end());  <span class="comment">//为了继续DFS重新将路径反转</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span><span class="params">(<span class="keyword">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(v == <span class="number">0</span>)&#123; <span class="comment">//这里我们逆序遍历路径，从终点车站开始到控制中心0为止</span></span><br><span class="line">        <span class="comment">//应为最短路径树中记录控制0为叶子结点，目标车站sp为根结点</span></span><br><span class="line">        path.push_back(<span class="number">0</span>);</span><br><span class="line">        judge();    <span class="comment">//判断当前路径的携带数与带回树是否可以优化答案</span></span><br><span class="line">        path.pop_back();</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    path.push_back(v);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> i : pre[v])&#123;</span><br><span class="line">        DFS(i);</span><br><span class="line">    &#125;</span><br><span class="line">    path.pop_back();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>, &amp;Cmax, &amp;n, &amp;sp, &amp;m) != EOF)&#123;    <span class="comment">//输入最大容量 车站数量 目标车站 道路数量</span></span><br><span class="line">        fill(G[<span class="number">0</span>], G[<span class="number">0</span>] + maxn * maxn, INT_MAX);    <span class="comment">//将所有车站之间设为不可达</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; maxn; i++)&#123;</span><br><span class="line">            pre[i].clear(); <span class="comment">//清空最短路径树</span></span><br><span class="line">        &#125;</span><br><span class="line">        path.clear();   <span class="comment">//清空用来记录每个路径的容器</span></span><br><span class="line">        ansPath.clear();    <span class="comment">//清空用来记录答案路径的容器</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;spValue[i]);   <span class="comment">//输入每个车站当前的车辆数</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)&#123; <span class="comment">//输入路径</span></span><br><span class="line">            <span class="keyword">int</span> u, v;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;u, &amp;v);  </span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;G[u][v]);</span><br><span class="line">            G[v][u] = G[u][v];  <span class="comment">//双向路径</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">memset</span>(vis, <span class="literal">false</span>, <span class="keyword">sizeof</span>(vis));    <span class="comment">//将所有车站设为未访问</span></span><br><span class="line">        fill(dis, dis + maxn, INT_MAX); <span class="comment">//所有车站到控制中心的距离为无穷大</span></span><br><span class="line">        Dijkstra(<span class="number">0</span>);    <span class="comment">//迪杰斯特拉获取最短路径树</span></span><br><span class="line">        minNeed = INT_MAX, minBack = INT_MAX;   <span class="comment">//记录答案携带数与带回数为无穷多</span></span><br><span class="line">        DFS(sp);    <span class="comment">//深搜最短路径树获取答案</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, minNeed); <span class="comment">//输出携带数</span></span><br><span class="line">        <span class="keyword">bool</span> flag = <span class="literal">false</span>; </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> i : ansPath)&#123;  <span class="comment">//输出路径</span></span><br><span class="line">            <span class="keyword">if</span>(flag)</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"-&gt;"</span>);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d"</span>, i);</span><br><span class="line">            flag = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">" %d\n"</span>, minBack);   <span class="comment">//输出带回数</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/DFS%EF%BC%88%E6%B7%B1%E5%BA%A6%E4%BC%98%E5%85%88%E6%90%9C%E7%B4%A2%EF%BC%89/" rel="tag"># DFS（深度优先搜索）</a>
              <a href="/tags/%E6%9C%80%E7%9F%AD%E8%B7%AF/" rel="tag"># 最短路</a>
              <a href="/tags/PTA/" rel="tag"># PTA</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2018/12/20/PTA-Advanced-Level-1016-Phone-Bills/" rel="prev" title="PTA (Advanced Level) 1016 Phone Bills">
      <i class="fa fa-chevron-left"></i> PTA (Advanced Level) 1016 Phone Bills
    </a></div>
      <div class="post-nav-item">
    <a href="/2019/01/01/PTA-Advanced-Level-1019-General-Palindromic-Number/" rel="next" title="PTA (Advanced Level) 1019 General Palindromic Number">
      PTA (Advanced Level) 1019 General Palindromic Number <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Input-Specification"><span class="nav-number">1.</span> <span class="nav-text">Input Specification:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Output-Specification"><span class="nav-number">2.</span> <span class="nav-text">Output Specification:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Sample-Input"><span class="nav-number">3.</span> <span class="nav-text">Sample Input:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Sample-Output"><span class="nav-number">4.</span> <span class="nav-text">Sample Output:</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="SUVVM"
      src="/images/ortrait.jpg">
  <p class="site-author-name" itemprop="name">SUVVM</p>
  <div class="site-description" itemprop="description">SUVVM的个人博客，主要涉及编程知识分享、算法题解等方面</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">152</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">85</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/suvvm" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;suvvm" rel="noopener" target="_blank"><i class="github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/suvvm@foxmail.com" title="E-Mail → suvvm@foxmail.com"><i class="envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">SUVVM</span>
	<a href="http://www.beian.miit.gov.cn/"  style="color:#f72b07" target="_blank">鲁ICP备19040043号-2</a>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>















  

  

  

</body>
</html>
